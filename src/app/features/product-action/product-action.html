<app-header></app-header>
<section class="min-h-screen bg-white text-black">
  <div class="max-w-6xl mx-auto px-6 lg:px-16 py-28">
    <!-- Header -->
    <div class="flex items-center justify-between gap-4">
      <div>
        <h1 class="text-3xl md:text-4xl font-light tracking-wide">
          Product Details
        </h1>
        <p class="text-black/60 mt-2">
          Select a variant, then choose how you want to purchase.
        </p>
      </div>

      <a
        routerLink="/shop"
        class="px-5 py-3 border border-black/20 rounded-full hover:bg-black hover:text-white transition"
      >
        Back to Shop
      </a>
    </div>

    <!-- Loading / Error -->
    <div *ngIf="loading()" class="mt-14 text-black/60">
      Loading product...
    </div>

    <div *ngIf="error()" class="mt-14 text-red-600">
      {{ error() }}
    </div>

    <!-- Content -->
    <div
      *ngIf="!loading() && !error() && product() as p"
      class="mt-14 grid grid-cols-1 lg:grid-cols-2 gap-12 items-start"
    >
      <!-- Image -->
      <div class="rounded-2xl overflow-hidden border border-black/10 bg-black/5">
        <img
          *ngIf="selectedImageUrl() as img"
          [src]="img"
          [alt]="p.title"
          class="w-full h-[420px] object-cover"
        />
        <div
          *ngIf="!selectedImageUrl()"
          class="h-[420px] flex items-center justify-center text-black/40"
        >
          No image
        </div>
      </div>

      <!-- Details -->
      <div>
        <h2 class="text-2xl md:text-3xl font-semibold tracking-wide">
          {{ p.title }}
        </h2>

        <p *ngIf="displayPrice() as price" class="mt-3 text-lg text-black/70">
          {{ price }}
        </p>

        <!-- Description -->
        <div
          *ngIf="p.body_html"
          class="prose max-w-none mt-6"
          [innerHTML]="p.body_html"
        ></div>

        <!-- Variant selector -->
        <div class="mt-8">
          <label class="block text-sm tracking-wide text-black/60 mb-2">
            Variant
          </label>

          <select
            class="w-full px-4 py-3 rounded-full border border-black/20 bg-white focus:outline-none focus:ring-2 focus:ring-black/20"
            [value]="selectedVariantId()"
            (change)="onVariantChange(($any($event.target).value))"
          >
            <option *ngFor="let v of variants()" [value]="v.id">
              {{ v.title }}
            </option>
          </select>
        </div>

        <!-- Qty -->
        <div class="mt-8 flex items-center gap-3">
          <span class="text-sm tracking-wide text-black/60">Quantity</span>

          <div
            class="flex items-center rounded-full border border-black/20 overflow-hidden"
          >
            <button
              class="rounded-full px-4 py-2 hover:bg-black hover:text-white transition"
              (click)="dec()"
              type="button"
            >
              âˆ’
            </button>

            <div class="px-5 py-2 min-w-[48px] text-center">
              {{ qty() }}
            </div>

            <button
              class="rounded-fullpx-4 py-2 hover:bg-black hover:text-white transition"
              (click)="inc()"
              type="button"
            >
              +
            </button>
          </div>
        </div>

        <!-- Actions -->
        <div class="mt-10 grid grid-cols-1 sm:grid-cols-2 gap-4">
          <button
            class="rounded-full px-6 py-4 rounded-full bg-black text-white hover:bg-black/90 transition disabled:opacity-40"
            [disabled]="!canBuy()"
            (click)="buyWithShop()"
            type="button"
          >
            Buy with Shop
          </button>

          <button
            class="rounded-full px-6 py-4 rounded-full border border-black/20 hover:bg-black hover:text-white transition disabled:opacity-40"
            [disabled]="!canAdd()"
            (click)="addToCart()"
            type="button"
          >
            Add to Cart
          </button>
        </div>
      </div>
    </div>
  </div>
</section>

<app-footer></app-footer>
